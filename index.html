<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>自动壁纸切换</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background-size: cover;
      background-position: center;
      font-family: sans-serif;
      overflow: hidden;
    }
    .btn {
      position: fixed;
      padding: 10px 16px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: rgba(0,0,0,0.4);
      color: white;
      cursor: pointer;
      z-index: 10;
    }
    .btn:hover {
      background-color: rgba(0,0,0,0.6);
    }
    #refreshBtn {
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
    }
    #downloadBtn {
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
    }
    #caption {
      position: fixed;
      bottom: 20px;
      width: 100%;
      text-align: center;
      color: white;
      text-shadow: 0 0 5px black;
      font-size: 1em;
      z-index: 5;
    }
  </style>
</head>
<body>
  <button id="refreshBtn" class="btn" onclick="loadWallpaper()">🔄 刷新</button>
  <a id="downloadBtn" class="btn" download target="_blank">📥 下载</a>
  <div id="caption">加载中...</div>

  <script>
    const caption = document.getElementById("caption");
    const downloadBtn = document.getElementById("downloadBtn");

    const apis = [
      { name: "搏天风景", url: "https://api.btstu.cn/sjbz/api.php?lx=fengjing&format=json", key: "imgurl" },
      { name: "小歪高清", url: "https://api.ixiaowai.cn/gqapi/gqapi.php?return=json", key: "imgurl" },
      { name: "LikePoems", url: "https://likepoems.com/api/img/pc?return=json", key: "imgurl" },
      { name: "360壁纸", url: "https://api.dujin.org/bing/1920.php?json", key: "url" }
    ];

    let currentIndex = 0;

    function loadWallpaper() {
      const api = apis[currentIndex % apis.length];
      fetch(api.url)
        .then(res => res.json())
        .then(data => {
          const imgUrl = data[api.key];
          document.body.style.backgroundImage = `url('${imgUrl}')`;
          downloadBtn.href = imgUrl;
          caption.innerText = `来源：${api.name}`;
        })
        .catch(() => {
          caption.innerText = "加载失败，请稍后重试";
        });
      currentIndex++;
    }

    window.onload = () => {
      loadWallpaper();
      setInterval(loadWallpaper, 60000); // 每分钟自动切换
    };
  </script>
</body>
</html>